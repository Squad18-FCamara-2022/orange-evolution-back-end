// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum Role {
  admin
  user
}

enum Status {
  in_progress
  finished
}

/// Modelo do usuário
model User {
  /// Id do usuário
  id             Int              @id @default(autoincrement())
  /// Email do usuário
  email          String           @unique
  /// Nome do usuário
  name           String
  /// senha do usuário
  password       String
  /// Cargo do usuário
  role           Role             @default(user)
  /// Momento da criação do usuário
  createdAt      DateTime         @default(now())
  UsersOnClasses UsersOnClasses[]
}

/// Modelo da Trilha
model Track {
  /// Id da trilha
  id          Int      @unique @default(autoincrement())
  /// Dome da trilha
  name        String
  /// Descrição da trilha
  description String
  /// Momento de criação da trilha
  createdAt   DateTime @default(now())
  /// Criador da trilha
  author      String
}

/// Modelo da Categoria
model Category {
  /// Id da Categoria
  id   Int    @unique @default(autoincrement())
  /// Nome da categoria
  name String

  classes Class[]
}

/// Modelo da Aula
model Class {
  /// Id da aula
  id          Int      @unique @default(autoincrement())
  /// Tipo do conteúdo da aula
  contentType String
  /// Autor da aula
  author      String
  /// duaração da aula em segundos
  duration    Int
  /// link para acessar a aula
  link        String
  /// momento de criação aula
  createdAt   DateTime @default(now())

  /// Id da categoria que a aula pertence
  categoryId     Int
  Category       Category         @relation(fields: [categoryId], references: [id])
  UsersOnClasses UsersOnClasses[]
}

/// https://www.prisma.io/docs/concepts/components/prisma-schema/relations/many-to-many-relations#explicit-many-to-many-relations
model UsersOnClasses {
  classId Int
  class   Class  @relation(fields: [classId], references: [id])
  userId  Int
  user    User   @relation(fields: [userId], references: [id])
  status  Status

  @@id([classId, userId])
}
